{"timestamp":"2017-05-08T15:48:59.966062+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T15:49:00.014451+12:00","level":"ERROR","logger":"Phobos::CLI","message":{"message":"Handler 'EventHandler' not defined"}}
{"timestamp":"2017-05-08T15:49:15.744326+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T15:49:15.776713+12:00","level":"ERROR","logger":"Phobos::CLI","message":{"message":"Handler 'EventHandler' not defined"}}
{"timestamp":"2017-05-08T15:50:06.513211+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T15:50:06.547900+12:00","level":"ERROR","logger":"Phobos::CLI","message":{"message":"Handler 'EventHandler' not defined"}}
{"timestamp":"2017-05-08T15:53:07.289691+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T15:53:07.339151+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"0221a3","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T15:53:07.390473+12:00","level":"INFO","logger":"Phobos","message":{"message":"I'm a message","listener_id":"0221a3","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":0,"retry_count":0}}
{"timestamp":"2017-05-08T15:53:07.390679+12:00","level":"INFO","logger":"Phobos","message":{"message":"I'm another message","listener_id":"0221a3","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":1,"retry_count":0}}
{"timestamp":"2017-05-08T15:53:07.390765+12:00","level":"INFO","logger":"Phobos","message":{"message":"And another","listener_id":"0221a3","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":2,"retry_count":0}}
{"timestamp":"2017-05-08T15:53:07.390832+12:00","level":"INFO","logger":"Phobos","message":{"message":"Committed offset","batch_size":3,"partition":0,"offset_lag":0,"highwater_mark_offset":3,"listener_id":"0221a3","group_id":"test-1","topic":"test","time_elapsed":0.0}}
{"timestamp":"2017-05-08T15:53:17.941621+12:00","level":"INFO","logger":"Phobos","message":{"message":"Can you hear me Phobos?","listener_id":"0221a3","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":3,"retry_count":0}}
{"timestamp":"2017-05-08T15:53:17.941893+12:00","level":"INFO","logger":"Phobos","message":{"message":"Committed offset","batch_size":1,"partition":0,"offset_lag":0,"highwater_mark_offset":4,"listener_id":"0221a3","group_id":"test-1","topic":"test","time_elapsed":0.0}}
{"timestamp":"2017-05-08T15:58:30.834806+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"0221a3","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T15:58:33.191132+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"0221a3","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T15:58:33.191385+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-08T15:58:35.942056+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T16:02:43.618909+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T16:03:03.787304+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T16:03:03.823300+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"af5897","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:03:16.089638+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.34s","waiting_time":0.34,"exception_class":"JSON::ParserError","exception_message":"784: unexpected token at 'What about now?'","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/json/common.rb:156:in `parse'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/json/common.rb:156:in `parse'","/Users/kalo/projects/lic/notifier/lib/event_handler.rb:14:in `consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:148:in `block in process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/handler.rb:19:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"af5897","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":4,"retry_count":0}}
{"timestamp":"2017-05-08T16:03:16.434927+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.68s","waiting_time":0.68,"exception_class":"JSON::ParserError","exception_message":"784: unexpected token at 'What about now?'","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/json/common.rb:156:in `parse'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/json/common.rb:156:in `parse'","/Users/kalo/projects/lic/notifier/lib/event_handler.rb:14:in `consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:148:in `block in process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/handler.rb:19:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"af5897","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":4,"retry_count":1}}
{"timestamp":"2017-05-08T16:03:17.120029+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 3.36s","waiting_time":3.36,"exception_class":"JSON::ParserError","exception_message":"784: unexpected token at 'What about now?'","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/json/common.rb:156:in `parse'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/json/common.rb:156:in `parse'","/Users/kalo/projects/lic/notifier/lib/event_handler.rb:14:in `consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:148:in `block in process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/handler.rb:19:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"af5897","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":4,"retry_count":2}}
{"timestamp":"2017-05-08T16:03:20.482268+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 11.71s","waiting_time":11.71,"exception_class":"JSON::ParserError","exception_message":"784: unexpected token at 'What about now?'","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/json/common.rb:156:in `parse'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/json/common.rb:156:in `parse'","/Users/kalo/projects/lic/notifier/lib/event_handler.rb:14:in `consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:148:in `block in process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/handler.rb:19:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"af5897","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":4,"retry_count":3}}
{"timestamp":"2017-05-08T16:03:32.198060+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 20.42s","waiting_time":20.42,"exception_class":"JSON::ParserError","exception_message":"784: unexpected token at 'What about now?'","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/json/common.rb:156:in `parse'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/json/common.rb:156:in `parse'","/Users/kalo/projects/lic/notifier/lib/event_handler.rb:14:in `consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:148:in `block in process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/handler.rb:19:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"af5897","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":4,"retry_count":4}}
{"timestamp":"2017-05-08T16:03:52.620129+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 22.84s","waiting_time":22.84,"exception_class":"JSON::ParserError","exception_message":"784: unexpected token at 'What about now?'","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/json/common.rb:156:in `parse'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/json/common.rb:156:in `parse'","/Users/kalo/projects/lic/notifier/lib/event_handler.rb:14:in `consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:148:in `block in process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/handler.rb:19:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"af5897","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":4,"retry_count":5}}
{"timestamp":"2017-05-08T16:04:00.767129+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"af5897","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:04:00.767451+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 4..4 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-08T16:04:00.768294+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"af5897","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:04:00.768449+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"af5897","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:04:00.768597+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-08T16:04:04.242561+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T16:04:04.278701+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"251844","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:04:04.284836+12:00","level":"INFO","logger":"Phobos","message":{"message":"Committed offset","batch_size":1,"partition":0,"offset_lag":0,"highwater_mark_offset":5,"listener_id":"251844","group_id":"test-1","topic":"test","time_elapsed":0.0}}
{"timestamp":"2017-05-08T16:04:13.188930+12:00","level":"INFO","logger":"Phobos","message":{"message":"Committed offset","batch_size":1,"partition":0,"offset_lag":0,"highwater_mark_offset":6,"listener_id":"251844","group_id":"test-1","topic":"test","time_elapsed":0.0}}
{"timestamp":"2017-05-08T16:05:24.805637+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"251844","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:05:28.256007+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"251844","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:05:28.256215+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-08T16:07:01.759430+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T16:07:01.797088+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"971e94","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:07:01.802690+12:00","level":"INFO","logger":"Phobos","message":{"message":"Committed offset","batch_size":1,"partition":0,"offset_lag":0,"highwater_mark_offset":7,"listener_id":"971e94","group_id":"test-1","topic":"test","time_elapsed":0.0}}
{"timestamp":"2017-05-08T16:07:22.999666+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"971e94","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:07:26.824505+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"971e94","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:07:26.824704+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-08T16:25:48.465739+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T16:27:35.716729+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T16:27:56.566688+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T16:28:54.602742+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T16:28:55.260638+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"43ab30","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:29:23.564023+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.19s","waiting_time":0.19,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"43ab30","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-08T16:29:28.760269+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.38s","waiting_time":1.38,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"43ab30","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-08T16:29:35.147721+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.76s","waiting_time":0.76,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"43ab30","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-08T16:29:40.915056+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 7.52s","waiting_time":7.52,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"43ab30","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-08T16:29:53.442584+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 9.03s","waiting_time":9.03,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"43ab30","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-08T16:30:07.477088+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 32.06s","waiting_time":32.06,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"43ab30","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-08T16:30:44.541234+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 32.37s","waiting_time":32.37,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"43ab30","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":6}}
{"timestamp":"2017-05-08T16:31:21.920996+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 12.37s","waiting_time":12.37,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"43ab30","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":7}}
{"timestamp":"2017-05-08T16:31:39.294526+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 60.37s","waiting_time":60.37,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"43ab30","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":8}}
{"timestamp":"2017-05-08T16:32:44.674489+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 41.37s","waiting_time":41.37,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"43ab30","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":9}}
{"timestamp":"2017-05-08T16:33:13.112097+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"43ab30","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:33:13.112619+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..7 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-08T16:33:13.113842+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"43ab30","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:33:13.114110+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"43ab30","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:33:13.114328+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-08T16:34:04.431841+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T16:34:05.098557+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"ebcba4","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:34:10.107587+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.92s","waiting_time":1.92,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ebcba4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-08T16:34:17.036274+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 2.18s","waiting_time":2.18,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ebcba4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-08T16:34:24.223031+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 4.6s","waiting_time":4.6,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ebcba4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-08T16:34:33.830432+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 7.68s","waiting_time":7.68,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ebcba4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-08T16:34:46.513198+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 15.19s","waiting_time":15.19,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ebcba4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-08T16:35:06.706964+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 30.38s","waiting_time":30.38,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ebcba4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-08T16:35:42.092208+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 56.96s","waiting_time":56.96,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ebcba4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":6}}
{"timestamp":"2017-05-08T16:36:44.060726+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 60.96s","waiting_time":60.96,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ebcba4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":7}}
{"timestamp":"2017-05-08T16:37:50.023937+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 61.96s","waiting_time":61.96,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ebcba4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":8}}
{"timestamp":"2017-05-08T16:38:56.991121+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 59.96s","waiting_time":59.96,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ebcba4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":9}}
{"timestamp":"2017-05-08T16:40:01.964557+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 58.96s","waiting_time":58.96,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ebcba4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":10}}
{"timestamp":"2017-05-08T16:41:05.932893+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 59.96s","waiting_time":59.96,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ebcba4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":11}}
{"timestamp":"2017-05-08T16:41:47.952044+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"ebcba4","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:41:47.952620+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..8 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-08T16:41:47.953897+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"ebcba4","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:41:47.954227+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"ebcba4","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:41:47.954518+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-08T16:41:51.543012+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T16:41:52.193058+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"30e30f","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:41:57.200436+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.53s","waiting_time":1.53,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"30e30f","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-08T16:42:03.736390+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.19s","waiting_time":1.19,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"30e30f","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-08T16:42:09.934326+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 3.39s","waiting_time":3.39,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"30e30f","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-08T16:42:18.328163+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 6.78s","waiting_time":6.78,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"30e30f","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-08T16:42:30.117246+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 12.56s","waiting_time":12.56,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"30e30f","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-08T16:42:47.685437+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 24.11s","waiting_time":24.11,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"30e30f","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-08T16:42:55.384940+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"30e30f","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:42:55.385394+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..9 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-08T16:42:55.386358+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"30e30f","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:42:55.386729+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"30e30f","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:42:55.387013+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-08T16:42:57.821107+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T16:42:58.476334+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"259707","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:43:03.481328+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.85s","waiting_time":0.85,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"259707","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-08T16:43:09.336624+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.49s","waiting_time":1.49,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"259707","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-08T16:43:15.834918+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 2.98s","waiting_time":2.98,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"259707","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-08T16:43:23.826163+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 5.95s","waiting_time":5.95,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"259707","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-08T16:43:34.785926+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 15.9s","waiting_time":15.9,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"259707","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-08T16:43:55.689694+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 33.81s","waiting_time":33.81,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"259707","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-08T16:44:34.504713+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 50.64s","waiting_time":50.64,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"259707","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":6}}
{"timestamp":"2017-05-08T16:45:30.155922+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 56.64s","waiting_time":56.64,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"259707","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":7}}
{"timestamp":"2017-05-08T16:46:31.801915+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 70.64s","waiting_time":70.64,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"259707","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":8}}
{"timestamp":"2017-05-08T16:47:47.453521+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 54.64s","waiting_time":54.64,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"259707","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":9}}
{"timestamp":"2017-05-08T16:48:47.100403+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 50.64s","waiting_time":50.64,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"259707","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":10}}
{"timestamp":"2017-05-08T16:49:42.744013+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 54.64s","waiting_time":54.64,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"259707","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":11}}
{"timestamp":"2017-05-08T16:50:42.394566+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 73.64s","waiting_time":73.64,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"259707","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":12}}
{"timestamp":"2017-05-08T16:52:01.041381+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 51.64s","waiting_time":51.64,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"259707","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":13}}
{"timestamp":"2017-05-08T16:52:57.687189+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 51.64s","waiting_time":51.64,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"259707","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":14}}
{"timestamp":"2017-05-08T16:53:30.006590+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"259707","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:53:30.007058+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..9 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-08T16:53:30.007810+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"259707","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:53:30.008128+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"259707","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:53:30.008407+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-08T16:53:32.605829+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T16:53:33.283475+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"4b1c19","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:53:38.291616+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.6s","waiting_time":1.6,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"4b1c19","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-08T16:53:44.901781+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.43s","waiting_time":1.43,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"4b1c19","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-08T16:53:51.337408+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 3.85s","waiting_time":3.85,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"4b1c19","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-08T16:54:00.197893+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 5.71s","waiting_time":5.71,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"4b1c19","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-08T16:54:10.918601+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 11.42s","waiting_time":11.42,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"4b1c19","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-08T16:54:27.346254+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 32.83s","waiting_time":32.83,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"4b1c19","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-08T16:55:05.183580+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 67.81s","waiting_time":67.81,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"4b1c19","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":6}}
{"timestamp":"2017-05-08T16:55:49.912644+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"4b1c19","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:55:49.913070+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..10 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-08T16:55:49.914074+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"4b1c19","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:55:49.914366+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"4b1c19","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:55:49.914639+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-08T16:55:52.128897+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T16:55:52.840604+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"6517e1","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:55:57.847245+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.29s","waiting_time":0.29,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"6517e1","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-08T16:56:03.143485+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.57s","waiting_time":1.57,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"6517e1","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-08T16:56:03.480578+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"6517e1","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:56:03.480987+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..10 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-08T16:56:03.483139+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"6517e1","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:56:03.483486+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"6517e1","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:56:03.483742+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-08T16:56:13.264192+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T16:56:13.918776+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"5372b0","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:56:18.926721+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.16s","waiting_time":0.16,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"5372b0","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-08T16:56:24.093330+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.31s","waiting_time":1.31,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"5372b0","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-08T16:56:30.411673+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 4.62s","waiting_time":4.62,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"5372b0","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-08T16:56:37.119245+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"5372b0","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:56:40.038122+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 2.25s","waiting_time":2.25,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"5372b0","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-08T16:56:42.292390+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..10 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-08T16:56:42.294490+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"5372b0","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:56:42.294768+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"5372b0","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:56:42.295042+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-08T16:56:44.729407+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T16:56:45.365883+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"0806b9","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:56:50.371750+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.08s","waiting_time":0.08,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0806b9","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-08T16:56:55.458860+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.15s","waiting_time":1.15,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0806b9","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-08T16:57:01.617147+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 5.3s","waiting_time":5.3,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0806b9","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-08T16:57:11.921603+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 13.6s","waiting_time":13.6,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0806b9","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-08T16:57:25.550764+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"0806b9","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:57:30.524477+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 23.2s","waiting_time":23.2,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0806b9","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-08T16:57:53.727069+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..10 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-08T16:57:53.728374+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"0806b9","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:57:53.728599+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"0806b9","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:57:53.728880+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-08T16:57:58.325316+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T16:57:58.991705+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"39235e","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T16:58:04.000439+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.53s","waiting_time":1.53,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-08T16:58:10.533502+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.34s","waiting_time":1.34,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-08T16:58:16.878831+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 3.68s","waiting_time":3.68,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-08T16:58:25.567573+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 5.37s","waiting_time":5.37,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-08T16:58:35.945297+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 15.74s","waiting_time":15.74,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-08T16:58:56.693698+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 21.48s","waiting_time":21.48,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-08T16:59:23.182613+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 51.27s","waiting_time":51.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":6}}
{"timestamp":"2017-05-08T17:00:19.458601+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 63.27s","waiting_time":63.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":7}}
{"timestamp":"2017-05-08T17:01:27.737753+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 56.27s","waiting_time":56.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":8}}
{"timestamp":"2017-05-08T17:02:29.020855+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 41.27s","waiting_time":41.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":9}}
{"timestamp":"2017-05-08T17:03:15.303714+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 69.27s","waiting_time":69.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":10}}
{"timestamp":"2017-05-08T17:04:29.590969+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 74.27s","waiting_time":74.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":11}}
{"timestamp":"2017-05-08T17:05:48.870512+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 42.27s","waiting_time":42.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":12}}
{"timestamp":"2017-05-08T17:06:36.151537+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 64.27s","waiting_time":64.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":13}}
{"timestamp":"2017-05-08T17:07:01.140346+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T17:07:02.138553+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"42c272","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T17:07:07.146736+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.01s","waiting_time":1.01,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"42c272","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-08T17:07:13.159515+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.02s","waiting_time":1.02,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"42c272","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-08T17:07:19.190978+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 3.03s","waiting_time":3.03,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"42c272","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-08T17:07:27.225356+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 8.06s","waiting_time":8.06,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"42c272","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-08T17:07:40.289468+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 10.12s","waiting_time":10.12,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"42c272","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-08T17:07:45.431999+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 78.27s","waiting_time":78.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":14}}
{"timestamp":"2017-05-08T17:07:55.414683+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 32.25s","waiting_time":32.25,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"42c272","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-08T17:08:32.672456+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 61.46s","waiting_time":61.46,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"42c272","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":6}}
{"timestamp":"2017-05-08T17:08:58.411904+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"42c272","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T17:08:58.412326+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..10 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-08T17:08:58.413275+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"42c272","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T17:08:58.413488+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"42c272","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T17:08:58.413753+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-08T17:09:00.489644+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-08T17:09:01.761843+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"0ef766","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-08T17:09:06.770537+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.12s","waiting_time":0.12,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-08T17:09:08.705557+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 40.27s","waiting_time":40.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":15}}
{"timestamp":"2017-05-08T17:09:11.903306+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 2.24s","waiting_time":2.24,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-08T17:09:19.152622+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 2.48s","waiting_time":2.48,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-08T17:09:26.637155+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 11.95s","waiting_time":11.95,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-08T17:09:43.593892+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 13.91s","waiting_time":13.91,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-08T17:09:53.984955+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 70.27s","waiting_time":70.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":16}}
{"timestamp":"2017-05-08T17:10:02.510378+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 39.81s","waiting_time":39.81,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-08T17:10:47.325306+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 105.14s","waiting_time":105.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":6}}
{"timestamp":"2017-05-08T17:11:09.262668+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 63.27s","waiting_time":63.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":17}}
{"timestamp":"2017-05-08T17:12:17.537067+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 42.27s","waiting_time":42.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":18}}
{"timestamp":"2017-05-08T17:12:37.474317+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 103.14s","waiting_time":103.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":7}}
{"timestamp":"2017-05-08T17:13:04.813384+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 49.27s","waiting_time":49.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":19}}
{"timestamp":"2017-05-08T17:13:59.094020+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 67.27s","waiting_time":67.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":20}}
{"timestamp":"2017-05-08T17:14:25.627351+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 39.14s","waiting_time":39.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":8}}
{"timestamp":"2017-05-08T17:15:09.776089+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 16.14s","waiting_time":16.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":9}}
{"timestamp":"2017-05-08T17:15:11.368043+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 76.27s","waiting_time":76.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":21}}
{"timestamp":"2017-05-08T17:15:30.925082+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 80.14s","waiting_time":80.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":10}}
{"timestamp":"2017-05-08T17:16:32.650020+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 71.27s","waiting_time":71.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":22}}
{"timestamp":"2017-05-08T17:16:56.071983+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 19.14s","waiting_time":19.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":11}}
{"timestamp":"2017-05-08T17:17:20.216746+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 42.14s","waiting_time":42.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":12}}
{"timestamp":"2017-05-08T17:17:48.938139+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 46.27s","waiting_time":46.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":23}}
{"timestamp":"2017-05-08T17:18:07.365465+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 13.14s","waiting_time":13.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":13}}
{"timestamp":"2017-05-08T17:18:25.514527+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 32.14s","waiting_time":32.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":14}}
{"timestamp":"2017-05-08T17:18:40.215855+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 52.27s","waiting_time":52.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":24}}
{"timestamp":"2017-05-08T17:19:02.664681+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 61.14s","waiting_time":61.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":15}}
{"timestamp":"2017-05-08T17:19:37.502658+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 53.27s","waiting_time":53.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.008 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":25}}
{"timestamp":"2017-05-08T17:20:08.824375+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 109.14s","waiting_time":109.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.008 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":16}}
{"timestamp":"2017-05-08T17:20:35.794368+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 40.27s","waiting_time":40.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.010 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":26}}
{"timestamp":"2017-05-08T17:21:21.075356+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 51.27s","waiting_time":51.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":27}}
{"timestamp":"2017-05-08T17:22:02.980574+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 88.14s","waiting_time":88.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.006 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":17}}
{"timestamp":"2017-05-08T17:22:17.357221+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 60.27s","waiting_time":60.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":28}}
{"timestamp":"2017-05-08T17:23:22.633353+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 78.27s","waiting_time":78.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":29}}
{"timestamp":"2017-05-08T17:23:36.134245+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 33.14s","waiting_time":33.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":18}}
{"timestamp":"2017-05-08T17:27:31.004526+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 75.14s","waiting_time":75.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 201.718 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":19}}
{"timestamp":"2017-05-08T20:24:19.625749+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 70.27s","waiting_time":70.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 10570.014 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":30}}
{"timestamp":"2017-05-09T05:24:58.735231+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 66.14s","waiting_time":66.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.009 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":20}}
{"timestamp":"2017-05-09T05:25:08.313507+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 61.27s","waiting_time":61.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.009 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":31}}
{"timestamp":"2017-05-09T09:16:10.413961+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 59.27s","waiting_time":59.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.011 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":32}}
{"timestamp":"2017-05-09T09:16:10.853736+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 33.14s","waiting_time":33.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":21}}
{"timestamp":"2017-05-09T09:16:49.023750+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 97.14s","waiting_time":97.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":22}}
{"timestamp":"2017-05-09T09:17:14.730970+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 76.27s","waiting_time":76.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":33}}
{"timestamp":"2017-05-09T09:18:31.180270+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 96.14s","waiting_time":96.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0ef766","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":23}}
{"timestamp":"2017-05-09T09:18:36.015774+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 72.27s","waiting_time":72.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":34}}
{"timestamp":"2017-05-09T09:18:40.358980+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"0ef766","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T09:18:40.360341+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..10 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T09:18:40.364322+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"0ef766","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T09:18:40.365884+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"0ef766","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T09:18:40.367224+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T09:19:53.303770+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 42.27s","waiting_time":42.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":35}}
{"timestamp":"2017-05-09T09:20:40.589744+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 40.27s","waiting_time":40.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":36}}
{"timestamp":"2017-05-09T09:21:25.869494+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 65.27s","waiting_time":65.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":37}}
{"timestamp":"2017-05-09T09:22:28.540405+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T09:22:29.631691+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"ad8259","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T09:22:34.643254+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.15s","waiting_time":0.15,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ad8259","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-09T09:22:36.151190+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 62.27s","waiting_time":62.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":38}}
{"timestamp":"2017-05-09T09:22:39.802730+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 2.3s","waiting_time":2.3,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ad8259","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-09T09:22:47.110898+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.61s","waiting_time":1.61,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ad8259","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-09T09:22:53.728665+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 13.21s","waiting_time":13.21,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ad8259","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-09T09:23:11.947924+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 25.42s","waiting_time":25.42,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ad8259","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-09T09:23:42.372677+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 57.84s","waiting_time":57.84,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"ad8259","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-09T09:23:43.431507+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 43.27s","waiting_time":43.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":39}}
{"timestamp":"2017-05-09T09:23:52.291263+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"ad8259","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T09:23:52.291731+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..10 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T09:23:52.292906+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"ad8259","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T09:23:52.293167+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"ad8259","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T09:23:52.293556+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T09:23:54.563248+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T09:24:05.156786+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T09:24:05.787942+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"0cf1f6","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T09:24:10.796506+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.4s","waiting_time":0.4,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-2.4.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0cf1f6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-09T09:24:16.205771+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.81s","waiting_time":1.81,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-2.4.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0cf1f6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-09T09:24:23.021773+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 4.62s","waiting_time":4.62,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-2.4.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0cf1f6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-09T09:24:31.709596+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 68.27s","waiting_time":68.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":40}}
{"timestamp":"2017-05-09T09:24:32.647105+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 7.23s","waiting_time":7.23,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-2.4.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0cf1f6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-09T09:24:43.570419+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"0cf1f6","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T09:24:44.883725+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 15.47s","waiting_time":15.47,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-2.4.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"0cf1f6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-09T09:24:59.225477+12:00","level":"ERROR","logger":"Phobos","message":{"message":"Listener crashed, waiting 0.34s (Input/output error @ io_write - \u003cSTDOUT\u003e)","listener_id":"0cf1f6","retry_count":0,"waiting_time":0.34,"exception_class":"Errno::EIO","exception_message":"Input/output error @ io_write - \u003cSTDOUT\u003e","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/appenders/io.rb:73:in `write'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/appenders/io.rb:73:in `canonical_write'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/appenders/buffering.rb:285:in `write'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/appender.rb:81:in `append'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/logger.rb:397:in `block in log_event'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/logger.rb:397:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/logger.rb:397:in `log_event'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/logger.rb:98:in `info'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:84:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:72:in `ensure in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:72:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]}}
{"timestamp":"2017-05-09T09:25:44.989066+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 54.27s","waiting_time":54.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":41}}
{"timestamp":"2017-05-09T09:26:44.267028+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 46.27s","waiting_time":46.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":42}}
{"timestamp":"2017-05-09T09:26:49.019819+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T09:26:49.648711+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"51f2ce","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T09:26:54.658367+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.79s","waiting_time":0.79,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"51f2ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-09T09:27:00.454869+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.37s","waiting_time":1.37,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"51f2ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-09T09:27:06.834154+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 3.74s","waiting_time":3.74,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"51f2ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-09T09:27:15.582506+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 5.48s","waiting_time":5.48,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"51f2ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-09T09:27:26.066271+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 12.96s","waiting_time":12.96,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"51f2ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-09T09:27:35.542983+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 78.27s","waiting_time":78.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":43}}
{"timestamp":"2017-05-09T09:27:44.031331+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 34.92s","waiting_time":34.92,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"51f2ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-09T09:28:23.959170+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 49.1s","waiting_time":49.1,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"51f2ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":6}}
{"timestamp":"2017-05-09T09:28:58.825357+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 48.27s","waiting_time":48.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":44}}
{"timestamp":"2017-05-09T09:29:18.069070+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 63.1s","waiting_time":63.1,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"51f2ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":7}}
{"timestamp":"2017-05-09T09:29:52.103020+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 72.27s","waiting_time":72.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":45}}
{"timestamp":"2017-05-09T09:30:26.174815+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 58.1s","waiting_time":58.1,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"51f2ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":8}}
{"timestamp":"2017-05-09T09:31:09.386685+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 46.27s","waiting_time":46.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":46}}
{"timestamp":"2017-05-09T09:31:29.286310+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 42.1s","waiting_time":42.1,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"51f2ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":9}}
{"timestamp":"2017-05-09T09:32:00.668829+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 49.27s","waiting_time":49.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":47}}
{"timestamp":"2017-05-09T09:32:16.394338+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 41.1s","waiting_time":41.1,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"51f2ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":10}}
{"timestamp":"2017-05-09T09:32:54.951501+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 53.27s","waiting_time":53.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":48}}
{"timestamp":"2017-05-09T09:33:02.503287+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 53.1s","waiting_time":53.1,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"51f2ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":11}}
{"timestamp":"2017-05-09T09:33:53.234026+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 73.27s","waiting_time":73.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":49}}
{"timestamp":"2017-05-09T09:34:00.612433+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 75.1s","waiting_time":75.1,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"51f2ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":12}}
{"timestamp":"2017-05-09T09:34:40.985224+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"51f2ce","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T09:34:40.985697+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..10 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T09:34:40.986959+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"51f2ce","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T09:34:40.987203+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"51f2ce","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T09:34:40.987508+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T09:35:11.521091+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 60.27s","waiting_time":60.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":50}}
{"timestamp":"2017-05-09T09:35:51.427566+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T09:35:52.092475+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"a6b77d","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T09:35:57.102176+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.13s","waiting_time":0.13,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"a6b77d","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-09T09:36:02.239547+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 2.25s","waiting_time":2.25,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"a6b77d","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-09T09:36:09.497687+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.51s","waiting_time":0.51,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"a6b77d","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-09T09:36:15.013547+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 9.02s","waiting_time":9.02,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"a6b77d","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-09T09:36:16.797259+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 67.27s","waiting_time":67.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":51}}
{"timestamp":"2017-05-09T09:36:29.039064+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 11.03s","waiting_time":11.03,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"a6b77d","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-09T09:36:45.075035+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 45.07s","waiting_time":45.07,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"a6b77d","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-09T09:37:29.077402+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 68.27s","waiting_time":68.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":52}}
{"timestamp":"2017-05-09T09:37:35.154574+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 57.62s","waiting_time":57.62,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"a6b77d","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":6}}
{"timestamp":"2017-05-09T09:38:37.786024+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 98.62s","waiting_time":98.62,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"a6b77d","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":7}}
{"timestamp":"2017-05-09T09:38:42.353589+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 53.27s","waiting_time":53.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":53}}
{"timestamp":"2017-05-09T09:39:40.637142+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 56.27s","waiting_time":56.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":54}}
{"timestamp":"2017-05-09T09:40:21.418661+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 59.62s","waiting_time":59.62,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"a6b77d","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":8}}
{"timestamp":"2017-05-09T09:40:41.915373+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 72.27s","waiting_time":72.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":55}}
{"timestamp":"2017-05-09T09:41:02.083386+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"a6b77d","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T09:41:02.083775+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..10 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T09:41:02.084854+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"a6b77d","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T09:41:02.085099+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"a6b77d","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T09:41:02.085341+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T09:41:59.197901+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 73.27s","waiting_time":73.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":56}}
{"timestamp":"2017-05-09T09:43:17.479095+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 55.27s","waiting_time":55.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":57}}
{"timestamp":"2017-05-09T09:44:17.757654+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 57.27s","waiting_time":57.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":58}}
{"timestamp":"2017-05-09T09:45:20.041655+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 67.27s","waiting_time":67.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":59}}
{"timestamp":"2017-05-09T09:46:32.319112+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 71.27s","waiting_time":71.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":60}}
{"timestamp":"2017-05-09T09:47:48.595198+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 76.27s","waiting_time":76.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":61}}
{"timestamp":"2017-05-09T09:49:09.870056+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 66.27s","waiting_time":66.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":62}}
{"timestamp":"2017-05-09T09:50:21.148763+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 71.27s","waiting_time":71.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":63}}
{"timestamp":"2017-05-09T09:51:37.424201+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 64.27s","waiting_time":64.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":64}}
{"timestamp":"2017-05-09T09:52:46.706237+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 57.27s","waiting_time":57.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":65}}
{"timestamp":"2017-05-09T09:53:48.987028+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 48.27s","waiting_time":48.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":66}}
{"timestamp":"2017-05-09T09:54:42.265719+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 51.27s","waiting_time":51.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":67}}
{"timestamp":"2017-05-09T09:55:38.551666+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 68.27s","waiting_time":68.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":68}}
{"timestamp":"2017-05-09T09:56:51.832968+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 51.27s","waiting_time":51.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":69}}
{"timestamp":"2017-05-09T09:57:48.114057+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 72.27s","waiting_time":72.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":70}}
{"timestamp":"2017-05-09T09:59:05.396932+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 54.27s","waiting_time":54.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":71}}
{"timestamp":"2017-05-09T10:00:04.683312+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 45.27s","waiting_time":45.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":72}}
{"timestamp":"2017-05-09T10:00:54.966043+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 55.27s","waiting_time":55.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":73}}
{"timestamp":"2017-05-09T10:01:55.252874+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 48.27s","waiting_time":48.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.006 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":74}}
{"timestamp":"2017-05-09T10:02:48.537430+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 70.27s","waiting_time":70.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.006 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":75}}
{"timestamp":"2017-05-09T10:04:03.823164+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 61.27s","waiting_time":61.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.010 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":76}}
{"timestamp":"2017-05-09T10:05:10.111677+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 52.27s","waiting_time":52.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.010 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":77}}
{"timestamp":"2017-05-09T10:06:07.389583+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 66.27s","waiting_time":66.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":78}}
{"timestamp":"2017-05-09T10:07:18.666440+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 48.27s","waiting_time":48.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":79}}
{"timestamp":"2017-05-09T10:08:11.943225+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 65.27s","waiting_time":65.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":80}}
{"timestamp":"2017-05-09T10:09:22.219096+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 60.27s","waiting_time":60.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":81}}
{"timestamp":"2017-05-09T10:10:29.756397+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 53.27s","waiting_time":53.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":82}}
{"timestamp":"2017-05-09T10:11:28.035787+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 54.27s","waiting_time":54.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":83}}
{"timestamp":"2017-05-09T10:12:27.316960+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 45.27s","waiting_time":45.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"39235e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":84}}
{"timestamp":"2017-05-09T10:13:11.178260+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"39235e","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T10:13:11.178843+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..10 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T10:13:11.179923+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"39235e","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T10:13:11.180154+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"39235e","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T10:13:11.180438+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T10:13:58.580347+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T10:13:59.905427+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"6037dc","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T10:14:04.911309+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.84s","waiting_time":0.84,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"6037dc","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-09T10:14:10.757574+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.23s","waiting_time":1.23,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"6037dc","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-09T10:14:16.993737+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 4.46s","waiting_time":4.46,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"6037dc","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-09T10:14:26.465142+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 4.91s","waiting_time":4.91,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"6037dc","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-09T10:14:36.386110+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 16.82s","waiting_time":16.82,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"6037dc","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-09T10:14:58.211209+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 37.65s","waiting_time":37.65,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"6037dc","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-09T10:15:40.868238+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 60.84s","waiting_time":60.84,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"6037dc","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":6}}
{"timestamp":"2017-05-09T10:16:46.720373+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 44.84s","waiting_time":44.84,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"6037dc","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":7}}
{"timestamp":"2017-05-09T10:17:36.567619+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 50.84s","waiting_time":50.84,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"6037dc","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":8}}
{"timestamp":"2017-05-09T10:18:32.412458+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 56.84s","waiting_time":56.84,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"6037dc","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":9}}
{"timestamp":"2017-05-09T10:18:58.615553+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"6037dc","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T10:18:58.616038+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..10 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T10:18:58.617293+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"6037dc","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T10:18:58.617645+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"6037dc","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T10:18:58.617924+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T10:20:55.315712+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T10:20:55.964867+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"1a307f","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T10:21:00.975037+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.35s","waiting_time":0.35,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-0.4.0/lib/phobos_db_checkpoint/handler.rb:18:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"1a307f","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-09T10:21:06.330331+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.7s","waiting_time":0.7,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-0.4.0/lib/phobos_db_checkpoint/handler.rb:18:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"1a307f","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-09T10:21:12.039246+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.41s","waiting_time":1.41,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-0.4.0/lib/phobos_db_checkpoint/handler.rb:18:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"1a307f","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-09T10:21:18.453705+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 11.81s","waiting_time":11.81,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-0.4.0/lib/phobos_db_checkpoint/handler.rb:18:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"1a307f","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-09T10:21:35.271019+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 7.63s","waiting_time":7.63,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-0.4.0/lib/phobos_db_checkpoint/handler.rb:18:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"1a307f","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-09T10:21:47.911725+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 18.25s","waiting_time":18.25,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-0.4.0/lib/phobos_db_checkpoint/handler.rb:18:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"1a307f","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-09T10:21:55.680078+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"1a307f","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T10:21:55.680526+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..11 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T10:21:55.681576+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"1a307f","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T10:21:55.681858+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"1a307f","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T10:21:55.682093+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T10:25:39.390073+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T10:25:40.069003+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"50cc53","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T10:25:45.079057+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.7s","waiting_time":0.7,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"50cc53","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-09T10:25:50.785704+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.07s","waiting_time":1.07,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"50cc53","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-09T10:25:56.867323+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 3.15s","waiting_time":3.15,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"50cc53","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-09T10:26:05.025162+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 4.29s","waiting_time":4.29,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"50cc53","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-09T10:26:14.321268+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 20.59s","waiting_time":20.59,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"50cc53","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-09T10:26:39.919309+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 23.17s","waiting_time":23.17,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"50cc53","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-09T10:27:08.094915+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 81.2s","waiting_time":81.2,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"50cc53","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":6}}
{"timestamp":"2017-05-09T10:28:34.301297+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 51.2s","waiting_time":51.2,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"50cc53","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":7}}
{"timestamp":"2017-05-09T10:29:30.513160+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 77.2s","waiting_time":77.2,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"50cc53","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":8}}
{"timestamp":"2017-05-09T10:30:52.721642+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 81.2s","waiting_time":81.2,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"50cc53","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":9}}
{"timestamp":"2017-05-09T10:32:18.927359+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 53.2s","waiting_time":53.2,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"50cc53","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":10}}
{"timestamp":"2017-05-09T10:32:20.532867+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"50cc53","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T10:32:20.533267+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..11 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T10:32:20.534384+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"50cc53","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T10:32:20.534609+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"50cc53","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T10:32:20.534935+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T11:08:14.753690+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T11:09:59.144096+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T11:10:00.316526+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"d565c4","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:10:05.391268+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.49s","waiting_time":1.49,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"d565c4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-09T11:10:11.886808+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 2.16s","waiting_time":2.16,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"d565c4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-09T11:10:19.050477+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 4.03s","waiting_time":4.03,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"d565c4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-09T11:10:28.088712+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 7.77s","waiting_time":7.77,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"d565c4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-09T11:10:40.865494+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 15.06s","waiting_time":15.06,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"d565c4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-09T11:11:00.930541+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 32.13s","waiting_time":32.13,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"d565c4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-09T11:11:38.065619+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 60.49s","waiting_time":60.49,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"d565c4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":6}}
{"timestamp":"2017-05-09T11:12:43.564235+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 58.49s","waiting_time":58.49,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"d565c4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":7}}
{"timestamp":"2017-05-09T11:13:47.062067+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 60.49s","waiting_time":60.49,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"d565c4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":8}}
{"timestamp":"2017-05-09T11:14:52.560278+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 60.49s","waiting_time":60.49,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"d565c4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":9}}
{"timestamp":"2017-05-09T11:15:58.058478+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 59.49s","waiting_time":59.49,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"d565c4","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":10}}
{"timestamp":"2017-05-09T11:16:41.956437+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"d565c4","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:16:41.956889+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..11 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T11:16:41.964958+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"d565c4","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:16:41.965346+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"d565c4","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:16:41.965649+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T11:16:44.799436+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T11:16:45.451294+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"e999da","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:16:50.460891+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.59s","waiting_time":0.59,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"e999da","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-09T11:16:56.056863+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.11s","waiting_time":1.11,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"e999da","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-09T11:17:02.172910+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 2.21s","waiting_time":2.21,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"e999da","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-09T11:17:03.623488+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"e999da","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:17:03.623935+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..11 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T11:17:03.626157+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"e999da","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:17:03.626497+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"e999da","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:17:03.626756+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T11:17:29.191409+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T11:17:30.287295+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"baed38","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:17:35.298559+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.2s","waiting_time":0.2,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"baed38","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-09T11:17:40.505565+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.4s","waiting_time":0.4,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"baed38","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-09T11:17:45.912407+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 5.8s","waiting_time":5.8,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"baed38","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-09T11:17:56.721583+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 3.61s","waiting_time":3.61,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"baed38","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-09T11:18:05.338957+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 13.22s","waiting_time":13.22,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"baed38","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-09T11:18:23.566550+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 39.44s","waiting_time":39.44,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"baed38","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-09T11:19:08.010741+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 58.07s","waiting_time":58.07,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"baed38","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":6}}
{"timestamp":"2017-05-09T11:20:11.089920+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 104.07s","waiting_time":104.07,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"baed38","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":7}}
{"timestamp":"2017-05-09T11:22:00.170095+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 65.07s","waiting_time":65.07,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"baed38","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":8}}
{"timestamp":"2017-05-09T11:23:10.248759+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 25.07s","waiting_time":25.07,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"baed38","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":9}}
{"timestamp":"2017-05-09T11:23:40.330446+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 15.07s","waiting_time":15.07,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"baed38","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":10}}
{"timestamp":"2017-05-09T11:24:00.407379+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 80.07s","waiting_time":80.07,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"baed38","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":11}}
{"timestamp":"2017-05-09T11:25:25.485765+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 23.07s","waiting_time":23.07,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"baed38","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":12}}
{"timestamp":"2017-05-09T11:25:53.567508+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 95.07s","waiting_time":95.07,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"baed38","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":13}}
{"timestamp":"2017-05-09T11:27:33.646042+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 93.07s","waiting_time":93.07,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"baed38","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":14}}
{"timestamp":"2017-05-09T11:29:11.734001+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 85.07s","waiting_time":85.07,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"baed38","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":15}}
{"timestamp":"2017-05-09T11:30:41.813726+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 84.07s","waiting_time":84.07,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"baed38","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":16}}
{"timestamp":"2017-05-09T11:31:34.966281+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"baed38","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:31:34.966968+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..11 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T11:31:34.967717+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"baed38","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:31:34.967915+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"baed38","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:31:34.968397+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T11:31:37.505274+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T11:31:38.149825+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"033eee","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:31:43.158171+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.43s","waiting_time":0.43,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"033eee","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-09T11:31:48.593801+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.86s","waiting_time":1.86,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"033eee","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-09T11:31:55.459091+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 4.72s","waiting_time":4.72,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"033eee","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-09T11:32:05.185480+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 10.44s","waiting_time":10.44,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"033eee","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-09T11:32:11.754934+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"033eee","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:32:11.755404+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..12 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T11:32:11.756378+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"033eee","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:32:11.756713+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"033eee","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:32:11.756975+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T11:32:46.709780+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T11:32:47.828850+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"7e7b73","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:32:52.837598+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.22s","waiting_time":0.22,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"7e7b73","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-09T11:32:58.066067+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 2.44s","waiting_time":2.44,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"7e7b73","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-09T11:33:05.514197+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 2.88s","waiting_time":2.88,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"7e7b73","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-09T11:33:13.400588+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 5.77s","waiting_time":5.77,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"7e7b73","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-09T11:33:24.177388+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 18.53s","waiting_time":18.53,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"7e7b73","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-09T11:33:47.716842+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 47.06s","waiting_time":47.06,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"7e7b73","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-09T11:34:14.402433+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"7e7b73","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:34:14.403051+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..12 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T11:34:14.404473+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"7e7b73","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:34:14.405001+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"7e7b73","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:34:14.405427+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T11:34:16.197810+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T11:34:16.835961+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"981703","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:34:21.844349+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.01s","waiting_time":0.01,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"981703","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-09T11:34:26.859892+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.02s","waiting_time":1.02,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"981703","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-09T11:34:26.923766+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"981703","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:34:26.924118+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..12 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T11:34:26.926258+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"981703","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:34:26.926604+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"981703","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:34:26.926855+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T11:34:35.339971+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T11:34:36.427969+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"00d576","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:34:41.436614+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.05s","waiting_time":1.05,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"00d576","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-09T11:34:47.491135+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.41s","waiting_time":1.41,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"00d576","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-09T11:34:53.905562+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 3.82s","waiting_time":3.82,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"00d576","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-09T11:35:02.729410+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 6.65s","waiting_time":6.65,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"00d576","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-09T11:35:14.388160+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 13.29s","waiting_time":13.29,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"00d576","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":4}}
{"timestamp":"2017-05-09T11:35:32.689181+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 29.59s","waiting_time":29.59,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"00d576","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":5}}
{"timestamp":"2017-05-09T11:36:07.285958+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 61.35s","waiting_time":61.35,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"00d576","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":6}}
{"timestamp":"2017-05-09T11:37:13.646921+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 72.35s","waiting_time":72.35,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"00d576","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":7}}
{"timestamp":"2017-05-09T11:38:31.004781+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 57.35s","waiting_time":57.35,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"00d576","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":8}}
{"timestamp":"2017-05-09T11:38:32.974640+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"00d576","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:38:32.975083+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..12 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T11:38:32.976418+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"00d576","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:38:32.976973+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"00d576","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:38:32.977407+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T11:51:22.864271+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T11:51:23.554244+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"1250c7","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:51:28.563208+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.49s","waiting_time":0.49,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"1250c7","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-09T11:51:34.060810+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.98s","waiting_time":0.98,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"1250c7","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-09T11:51:40.051617+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.96s","waiting_time":1.96,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"1250c7","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-09T11:51:43.238781+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"1250c7","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:51:47.017788+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 7.91s","waiting_time":7.91,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"1250c7","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-09T11:51:54.930089+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..12 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T11:51:54.931570+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"1250c7","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:51:54.931864+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"1250c7","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:51:54.932151+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T11:52:09.163999+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T11:52:09.789702+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"e70933","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:52:14.797995+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.93s","waiting_time":0.93,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"e70933","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":0}}
{"timestamp":"2017-05-09T11:52:20.734958+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.74s","waiting_time":1.74,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"e70933","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":1}}
{"timestamp":"2017-05-09T11:52:27.480621+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 3.31s","waiting_time":3.31,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"e70933","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":2}}
{"timestamp":"2017-05-09T11:52:35.794815+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 6.61s","waiting_time":6.61,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"e70933","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":7,"retry_count":3}}
{"timestamp":"2017-05-09T11:52:39.556764+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"e70933","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:52:39.557259+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 7..12 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T11:52:39.560293+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"e70933","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:52:39.560585+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"e70933","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:52:39.560822+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T11:53:55.822597+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T11:54:18.723395+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T11:54:36.658408+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T11:55:48.295036+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T11:56:18.753228+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T11:56:19.412501+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"d05192","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T11:56:19.462928+12:00","level":"INFO","logger":"Phobos","message":{"message":"Committed offset","batch_size":6,"partition":0,"offset_lag":0,"highwater_mark_offset":13,"listener_id":"d05192","group_id":"test-1","topic":"test","time_elapsed":0.045}}
{"timestamp":"2017-05-09T13:33:03.471214+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"d05192","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T13:33:04.431289+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"d05192","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T13:33:04.431614+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T13:33:07.937168+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T13:33:34.964787+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T13:33:35.740056+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"14a42a","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T13:33:52.480496+12:00","level":"INFO","logger":"Phobos","message":{"message":"Committed offset","batch_size":1,"partition":0,"offset_lag":0,"highwater_mark_offset":14,"listener_id":"14a42a","group_id":"test-1","topic":"test","time_elapsed":0.043}}
{"timestamp":"2017-05-09T13:34:38.470984+12:00","level":"INFO","logger":"Phobos","message":{"message":"Committed offset","batch_size":1,"partition":0,"offset_lag":0,"highwater_mark_offset":15,"listener_id":"14a42a","group_id":"test-1","topic":"test","time_elapsed":0.002}}
{"timestamp":"2017-05-09T13:49:29.783631+12:00","level":"INFO","logger":"Phobos","message":{"message":"Committed offset","batch_size":1,"partition":0,"offset_lag":0,"highwater_mark_offset":16,"listener_id":"14a42a","group_id":"test-1","topic":"test","time_elapsed":0.001}}
{"timestamp":"2017-05-09T14:07:07.312811+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"14a42a","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:07:10.555723+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"14a42a","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:07:10.556065+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T14:08:26.364511+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T14:11:24.761193+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T14:11:25.301684+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"fb4293","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:12:00.410342+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.38s","waiting_time":1.38,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"fb4293","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":0}}
{"timestamp":"2017-05-09T14:12:06.798699+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.34s","waiting_time":1.34,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"fb4293","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":1}}
{"timestamp":"2017-05-09T14:12:13.146360+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 3.68s","waiting_time":3.68,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"fb4293","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":2}}
{"timestamp":"2017-05-09T14:12:21.831759+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 7.35s","waiting_time":7.35,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"fb4293","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":3}}
{"timestamp":"2017-05-09T14:12:34.189720+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 18.7s","waiting_time":18.7,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"fb4293","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":4}}
{"timestamp":"2017-05-09T14:12:57.897444+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 24.4s","waiting_time":24.4,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"fb4293","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":5}}
{"timestamp":"2017-05-09T14:13:27.303408+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 61.13s","waiting_time":61.13,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"fb4293","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":6}}
{"timestamp":"2017-05-09T14:14:33.442383+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 43.13s","waiting_time":43.13,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"fb4293","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":7}}
{"timestamp":"2017-05-09T14:15:21.584842+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 52.13s","waiting_time":52.13,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"fb4293","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":8}}
{"timestamp":"2017-05-09T14:16:18.722666+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 49.13s","waiting_time":49.13,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"fb4293","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":9}}
{"timestamp":"2017-05-09T14:17:01.138712+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"fb4293","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:17:01.139132+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 16..16 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T14:17:01.140110+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"fb4293","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:17:01.140345+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"fb4293","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:17:01.140561+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T14:17:30.499273+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T14:17:30.982248+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"3a1ef5","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:17:35.988559+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.04s","waiting_time":1.04,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3a1ef5","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":0}}
{"timestamp":"2017-05-09T14:17:42.032210+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 2.46s","waiting_time":2.46,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3a1ef5","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":1}}
{"timestamp":"2017-05-09T14:17:49.501453+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 4.22s","waiting_time":4.22,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3a1ef5","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":2}}
{"timestamp":"2017-05-09T14:17:58.729266+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 8.37s","waiting_time":8.37,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3a1ef5","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":3}}
{"timestamp":"2017-05-09T14:18:04.049609+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"3a1ef5","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:18:04.050026+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 16..16 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T14:18:04.051016+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"3a1ef5","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:18:04.051245+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"3a1ef5","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:18:04.051481+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T14:18:49.489902+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T14:18:49.938846+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"c7433a","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:18:54.945914+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.44s","waiting_time":0.44,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"c7433a","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":0}}
{"timestamp":"2017-05-09T14:19:00.393123+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.88s","waiting_time":1.88,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"c7433a","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":1}}
{"timestamp":"2017-05-09T14:19:07.282067+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 2.77s","waiting_time":2.77,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"c7433a","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":2}}
{"timestamp":"2017-05-09T14:19:15.062521+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 10.54s","waiting_time":10.54,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"c7433a","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":3}}
{"timestamp":"2017-05-09T14:19:30.611501+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 7.07s","waiting_time":7.07,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"c7433a","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":4}}
{"timestamp":"2017-05-09T14:19:42.688613+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 21.14s","waiting_time":21.14,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"c7433a","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":5}}
{"timestamp":"2017-05-09T14:20:01.736573+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"c7433a","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:20:01.736951+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 16..16 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T14:20:01.737984+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"c7433a","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:20:01.738170+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"c7433a","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:20:01.738354+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T14:20:05.729083+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T14:20:06.190884+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"3bb1a6","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:20:11.196390+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.72s","waiting_time":1.72,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":0}}
{"timestamp":"2017-05-09T14:20:17.925206+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 2.51s","waiting_time":2.51,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":1}}
{"timestamp":"2017-05-09T14:20:25.447739+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 4.36s","waiting_time":4.36,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":2}}
{"timestamp":"2017-05-09T14:20:34.814152+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 8.37s","waiting_time":8.37,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":3}}
{"timestamp":"2017-05-09T14:20:48.192855+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 16.35s","waiting_time":16.35,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":4}}
{"timestamp":"2017-05-09T14:21:09.547872+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 31.05s","waiting_time":31.05,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":5}}
{"timestamp":"2017-05-09T14:21:45.604231+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 59.21s","waiting_time":59.21,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":6}}
{"timestamp":"2017-05-09T14:22:49.823411+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 59.21s","waiting_time":59.21,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":7}}
{"timestamp":"2017-05-09T14:23:54.043442+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 59.21s","waiting_time":59.21,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":8}}
{"timestamp":"2017-05-09T14:24:58.262546+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 59.21s","waiting_time":59.21,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":9}}
{"timestamp":"2017-05-09T14:26:02.483233+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 58.21s","waiting_time":58.21,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":10}}
{"timestamp":"2017-05-09T14:27:05.700489+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 59.21s","waiting_time":59.21,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":11}}
{"timestamp":"2017-05-09T14:28:09.920950+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 58.21s","waiting_time":58.21,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":12}}
{"timestamp":"2017-05-09T14:29:13.138366+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 60.21s","waiting_time":60.21,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":13}}
{"timestamp":"2017-05-09T14:30:18.351664+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 60.21s","waiting_time":60.21,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":14}}
{"timestamp":"2017-05-09T14:31:23.568008+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 60.21s","waiting_time":60.21,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":15}}
{"timestamp":"2017-05-09T14:32:28.782272+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 58.21s","waiting_time":58.21,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":16}}
{"timestamp":"2017-05-09T14:33:31.997043+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 58.21s","waiting_time":58.21,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":17}}
{"timestamp":"2017-05-09T14:34:35.214327+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 58.21s","waiting_time":58.21,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":18}}
{"timestamp":"2017-05-09T14:35:38.431489+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 59.21s","waiting_time":59.21,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":19}}
{"timestamp":"2017-05-09T14:36:42.649571+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 59.21s","waiting_time":59.21,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"3bb1a6","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":20}}
{"timestamp":"2017-05-09T14:37:37.998908+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"3bb1a6","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:37:37.999356+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 16..16 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T14:37:38.000132+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"3bb1a6","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:37:38.000361+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"3bb1a6","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:37:38.000579+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T14:37:42.265476+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T14:37:42.726629+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"b4f1bb","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:37:47.733701+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.83s","waiting_time":1.83,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b4f1bb","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":0}}
{"timestamp":"2017-05-09T14:37:54.572595+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 2.32s","waiting_time":2.32,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b4f1bb","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":1}}
{"timestamp":"2017-05-09T14:38:01.905262+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 4.34s","waiting_time":4.34,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b4f1bb","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":2}}
{"timestamp":"2017-05-09T14:38:11.257410+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 8.09s","waiting_time":8.09,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b4f1bb","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":3}}
{"timestamp":"2017-05-09T14:38:24.359160+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 16.53s","waiting_time":16.53,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b4f1bb","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":4}}
{"timestamp":"2017-05-09T14:38:45.893460+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 31.38s","waiting_time":31.38,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b4f1bb","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":5}}
{"timestamp":"2017-05-09T14:39:22.281869+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 59.84s","waiting_time":59.84,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b4f1bb","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":6}}
{"timestamp":"2017-05-09T14:40:27.133073+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 58.84s","waiting_time":58.84,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b4f1bb","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":7}}
{"timestamp":"2017-05-09T14:41:30.985665+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 58.84s","waiting_time":58.84,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b4f1bb","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":8}}
{"timestamp":"2017-05-09T14:42:34.832338+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 59.84s","waiting_time":59.84,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b4f1bb","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":9}}
{"timestamp":"2017-05-09T14:43:39.677808+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 59.84s","waiting_time":59.84,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b4f1bb","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":10}}
{"timestamp":"2017-05-09T14:44:44.526283+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 59.84s","waiting_time":59.84,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b4f1bb","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":11}}
{"timestamp":"2017-05-09T14:45:49.370695+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 59.84s","waiting_time":59.84,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b4f1bb","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":12}}
{"timestamp":"2017-05-09T14:46:16.618933+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"b4f1bb","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:46:16.619327+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 16..16 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T14:46:16.620323+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"b4f1bb","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:46:16.620594+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"b4f1bb","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:46:16.620862+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T14:46:20.255380+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T14:46:20.709071+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"e8baac","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:46:25.719347+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.39s","waiting_time":0.39,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"e8baac","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":0}}
{"timestamp":"2017-05-09T14:46:31.119080+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.78s","waiting_time":1.78,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"e8baac","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":1}}
{"timestamp":"2017-05-09T14:46:37.904715+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 4.56s","waiting_time":4.56,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"e8baac","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":2}}
{"timestamp":"2017-05-09T14:46:47.471572+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 10.12s","waiting_time":10.12,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"e8baac","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":3}}
{"timestamp":"2017-05-09T14:47:02.599517+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 12.24s","waiting_time":12.24,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"e8baac","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":4}}
{"timestamp":"2017-05-09T14:47:18.100733+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"e8baac","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:47:19.842818+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 46.48s","waiting_time":46.48,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"e8baac","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":5}}
{"timestamp":"2017-05-09T14:47:54.026626+12:00","level":"ERROR","logger":"Phobos","message":{"message":"Listener crashed, waiting 1.67s (Input/output error @ io_write - \u003cSTDOUT\u003e)","listener_id":"e8baac","retry_count":0,"waiting_time":1.67,"exception_class":"Errno::EIO","exception_message":"Input/output error @ io_write - \u003cSTDOUT\u003e","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/appenders/io.rb:73:in `write'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/appenders/io.rb:73:in `canonical_write'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/appenders/buffering.rb:285:in `write'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/appender.rb:81:in `append'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/logger.rb:397:in `block in log_event'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/logger.rb:397:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/logger.rb:397:in `log_event'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/logger.rb:98:in `info'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:84:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:72:in `ensure in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:72:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]}}
{"timestamp":"2017-05-09T14:48:00.920762+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T14:49:39.313574+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T14:49:39.781720+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"8030ce","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:49:44.787159+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.71s","waiting_time":1.71,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"8030ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":0}}
{"timestamp":"2017-05-09T14:49:51.501397+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 2.39s","waiting_time":2.39,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"8030ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":1}}
{"timestamp":"2017-05-09T14:49:58.895531+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 3.18s","waiting_time":3.18,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"8030ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":2}}
{"timestamp":"2017-05-09T14:50:07.078734+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 7.36s","waiting_time":7.36,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"8030ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":3}}
{"timestamp":"2017-05-09T14:50:19.445985+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 12.71s","waiting_time":12.71,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"8030ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":4}}
{"timestamp":"2017-05-09T14:50:37.160560+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 35.42s","waiting_time":35.42,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"8030ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":5}}
{"timestamp":"2017-05-09T14:51:17.586768+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 69.66s","waiting_time":69.66,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"8030ce","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":6}}
{"timestamp":"2017-05-09T14:52:01.041779+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"8030ce","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:52:01.042158+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 16..16 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T14:52:01.048261+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"8030ce","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:52:01.048510+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"8030ce","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:52:01.048853+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T14:52:22.902719+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T14:52:23.374736+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"9795ed","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:52:28.379500+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.35s","waiting_time":0.35,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"9795ed","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":0}}
{"timestamp":"2017-05-09T14:52:33.734210+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.69s","waiting_time":0.69,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"9795ed","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":1}}
{"timestamp":"2017-05-09T14:52:39.431584+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.39s","waiting_time":1.39,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"9795ed","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":2}}
{"timestamp":"2017-05-09T14:52:45.829321+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 9.78s","waiting_time":9.78,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"9795ed","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":3}}
{"timestamp":"2017-05-09T14:53:00.614975+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 11.55s","waiting_time":11.55,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"9795ed","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":4}}
{"timestamp":"2017-05-09T14:53:17.170926+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 34.1s","waiting_time":34.1,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"9795ed","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":5}}
{"timestamp":"2017-05-09T14:53:56.279719+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 61.82s","waiting_time":61.82,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"9795ed","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":6}}
{"timestamp":"2017-05-09T14:55:03.107971+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 96.82s","waiting_time":96.82,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"9795ed","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":7}}
{"timestamp":"2017-05-09T14:56:44.945262+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 24.82s","waiting_time":24.82,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"9795ed","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":8}}
{"timestamp":"2017-05-09T14:57:05.247170+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"9795ed","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:57:05.247613+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 16..16 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T14:57:05.248727+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"9795ed","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:57:05.249010+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"9795ed","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:57:05.249245+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T14:57:07.543608+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T14:57:08.003552+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"91b7b2","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:57:13.008393+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.27s","waiting_time":1.27,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"91b7b2","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":0}}
{"timestamp":"2017-05-09T14:57:19.283806+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 1.23s","waiting_time":1.23,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"91b7b2","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":1}}
{"timestamp":"2017-05-09T14:57:25.525295+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 3.46s","waiting_time":3.46,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"91b7b2","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":2}}
{"timestamp":"2017-05-09T14:57:33.991103+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 9.92s","waiting_time":9.92,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"91b7b2","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":3}}
{"timestamp":"2017-05-09T14:57:48.918644+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 16.83s","waiting_time":16.83,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"91b7b2","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":4}}
{"timestamp":"2017-05-09T14:58:10.757226+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 23.66s","waiting_time":23.66,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"91b7b2","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":5}}
{"timestamp":"2017-05-09T14:58:39.426387+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 66.86s","waiting_time":66.86,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"91b7b2","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":16,"retry_count":6}}
{"timestamp":"2017-05-09T14:59:04.262918+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"91b7b2","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:59:04.263300+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 16..16 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T14:59:04.269824+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"91b7b2","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:59:04.270061+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"91b7b2","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:59:04.270277+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T14:59:06.365804+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T14:59:06.823774+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"e952a5","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:59:06.824344+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"493102","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:59:06.828191+12:00","level":"ERROR","logger":"RubyKafka","message":"Connection error while trying to join group `test-1`; retrying..."}
{"timestamp":"2017-05-09T14:59:06.834003+12:00","level":"ERROR","logger":"Phobos","message":{"message":"Listener crashed, waiting 0.47s (No partitions assigned!)","listener_id":"e952a5","retry_count":0,"waiting_time":0.47,"exception_class":"RuntimeError","exception_message":"No partitions assigned!","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:327:in `fetch_batches'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:237:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]}}
{"timestamp":"2017-05-09T14:59:06.883502+12:00","level":"INFO","logger":"Phobos","message":{"message":"Committed offset","batch_size":1,"partition":0,"offset_lag":0,"highwater_mark_offset":17,"listener_id":"493102","group_id":"test-1","topic":"test","time_elapsed":0.05}}
{"timestamp":"2017-05-09T14:59:07.311412+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"e952a5","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:59:16.890781+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T14:59:16.894457+12:00","level":"ERROR","logger":"Phobos","message":{"message":"Listener crashed, waiting 1.94s (No partitions assigned!)","listener_id":"e952a5","retry_count":1,"waiting_time":1.94,"exception_class":"RuntimeError","exception_message":"No partitions assigned!","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:327:in `fetch_batches'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:237:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]}}
{"timestamp":"2017-05-09T14:59:18.840870+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"e952a5","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:59:26.904597+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T14:59:26.907684+12:00","level":"ERROR","logger":"Phobos","message":{"message":"Listener crashed, waiting 3.87s (No partitions assigned!)","listener_id":"e952a5","retry_count":2,"waiting_time":3.87,"exception_class":"RuntimeError","exception_message":"No partitions assigned!","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:327:in `fetch_batches'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:237:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]}}
{"timestamp":"2017-05-09T14:59:30.784642+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"e952a5","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:59:36.912598+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T14:59:36.916142+12:00","level":"ERROR","logger":"Phobos","message":{"message":"Listener crashed, waiting 9.75s (No partitions assigned!)","listener_id":"e952a5","retry_count":3,"waiting_time":9.75,"exception_class":"RuntimeError","exception_message":"No partitions assigned!","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:327:in `fetch_batches'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:237:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]}}
{"timestamp":"2017-05-09T14:59:46.672769+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"e952a5","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T14:59:46.923592+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T14:59:46.926978+12:00","level":"ERROR","logger":"Phobos","message":{"message":"Listener crashed, waiting 18.49s (No partitions assigned!)","listener_id":"e952a5","retry_count":4,"waiting_time":18.49,"exception_class":"RuntimeError","exception_message":"No partitions assigned!","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:327:in `fetch_batches'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:237:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]}}
{"timestamp":"2017-05-09T14:59:56.931846+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T15:00:05.420797+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"e952a5","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T15:00:06.941658+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T15:00:06.944874+12:00","level":"ERROR","logger":"Phobos","message":{"message":"Listener crashed, waiting 20.99s (No partitions assigned!)","listener_id":"e952a5","retry_count":5,"waiting_time":20.99,"exception_class":"RuntimeError","exception_message":"No partitions assigned!","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:327:in `fetch_batches'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:237:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]}}
{"timestamp":"2017-05-09T15:00:16.950047+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T15:00:27.943622+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"e952a5","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T15:00:36.965840+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T15:00:36.968722+12:00","level":"ERROR","logger":"Phobos","message":{"message":"Listener crashed, waiting 49.1s (No partitions assigned!)","listener_id":"e952a5","retry_count":6,"waiting_time":49.1,"exception_class":"RuntimeError","exception_message":"No partitions assigned!","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:327:in `fetch_batches'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:237:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]}}
{"timestamp":"2017-05-09T15:00:46.973571+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T15:01:26.072517+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"e952a5","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T15:01:27.009819+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T15:01:27.013028+12:00","level":"ERROR","logger":"Phobos","message":{"message":"Listener crashed, waiting 28.1s (No partitions assigned!)","listener_id":"e952a5","retry_count":7,"waiting_time":28.1,"exception_class":"RuntimeError","exception_message":"No partitions assigned!","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:327:in `fetch_batches'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:237:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]}}
{"timestamp":"2017-05-09T15:01:37.018676+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T15:01:55.119400+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"e952a5","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T15:01:57.033639+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T15:01:57.036525+12:00","level":"ERROR","logger":"Phobos","message":{"message":"Listener crashed, waiting 64.1s (No partitions assigned!)","listener_id":"e952a5","retry_count":8,"waiting_time":64.1,"exception_class":"RuntimeError","exception_message":"No partitions assigned!","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:327:in `fetch_batches'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:237:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]}}
{"timestamp":"2017-05-09T15:02:07.042959+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T15:03:01.145093+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"e952a5","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T15:03:07.077527+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T15:03:07.080733+12:00","level":"ERROR","logger":"Phobos","message":{"message":"Listener crashed, waiting 38.1s (No partitions assigned!)","listener_id":"e952a5","retry_count":9,"waiting_time":38.1,"exception_class":"RuntimeError","exception_message":"No partitions assigned!","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:327:in `fetch_batches'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:237:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]}}
{"timestamp":"2017-05-09T15:03:17.086693+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T15:03:45.189282+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"e952a5","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T15:03:47.104968+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T15:03:47.108293+12:00","level":"ERROR","logger":"Phobos","message":{"message":"Listener crashed, waiting 47.1s (No partitions assigned!)","listener_id":"e952a5","retry_count":10,"waiting_time":47.1,"exception_class":"RuntimeError","exception_message":"No partitions assigned!","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:327:in `fetch_batches'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:237:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]}}
{"timestamp":"2017-05-09T15:03:57.112717+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T15:04:34.213183+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"e952a5","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T15:04:37.142070+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T15:04:37.145263+12:00","level":"ERROR","logger":"Phobos","message":{"message":"Listener crashed, waiting 37.1s (No partitions assigned!)","listener_id":"e952a5","retry_count":11,"waiting_time":37.1,"exception_class":"RuntimeError","exception_message":"No partitions assigned!","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:327:in `fetch_batches'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:237:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"]}}
{"timestamp":"2017-05-09T15:04:47.153013+12:00","level":"ERROR","logger":"RubyKafka","message":"Error sending heartbeat: Kafka::RebalanceInProgress"}
{"timestamp":"2017-05-09T15:05:03.412993+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"e952a5","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T15:05:03.413276+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"493102","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T15:05:07.168660+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"493102","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T15:05:07.168963+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T15:05:12.732251+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T15:05:13.194547+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"b9fd9e","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T15:06:27.927286+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.18s","waiting_time":0.18,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.005 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b9fd9e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":17,"retry_count":0}}
{"timestamp":"2017-05-09T15:06:33.116973+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.36s","waiting_time":0.36,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b9fd9e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":17,"retry_count":1}}
{"timestamp":"2017-05-09T15:06:38.486539+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.71s","waiting_time":0.71,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b9fd9e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":17,"retry_count":2}}
{"timestamp":"2017-05-09T15:06:44.204404+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 7.43s","waiting_time":7.43,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b9fd9e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":17,"retry_count":3}}
{"timestamp":"2017-05-09T15:06:56.645097+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 14.85s","waiting_time":14.85,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b9fd9e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":17,"retry_count":4}}
{"timestamp":"2017-05-09T15:07:16.509970+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 52.7s","waiting_time":52.7,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.004 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:717:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:490:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:364:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:883:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:128:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/connection_handling.rb:91:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:442:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_decorators.rb:28:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:437:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.2/lib/active_record/inheritance.rb:54:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"b9fd9e","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":17,"retry_count":5}}
{"timestamp":"2017-05-09T15:07:32.376468+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"b9fd9e","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T15:07:32.376860+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 17..17 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T15:07:32.377928+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"b9fd9e","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T15:07:32.378197+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"b9fd9e","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T15:07:32.378474+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-09T16:18:06.746325+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-09T16:18:07.233250+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"c9a09a","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T16:18:12.241380+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.42s","waiting_time":0.42,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.003 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"c9a09a","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":24,"retry_count":0}}
{"timestamp":"2017-05-09T16:18:17.667211+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 0.83s","waiting_time":0.83,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"c9a09a","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":24,"retry_count":1}}
{"timestamp":"2017-05-09T16:18:23.502722+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 2.67s","waiting_time":2.67,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.001 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"c9a09a","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":24,"retry_count":2}}
{"timestamp":"2017-05-09T16:18:31.180868+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 5.33s","waiting_time":5.33,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"c9a09a","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":24,"retry_count":3}}
{"timestamp":"2017-05-09T16:18:36.655330+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopping","listener_id":"c9a09a","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T16:18:41.517594+12:00","level":"ERROR","logger":"Phobos","message":{"message":"error processing message, waiting 11.66s","waiting_time":11.66,"exception_class":"ActiveRecord::ConnectionTimeoutError","exception_message":"could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use","backtrace":["/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:116:in `retrieve_connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/connection_handling.rb:88:in `connection'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:451:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attributes.rb:233:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_decorators.rb:50:in `load_schema!'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:446:in `load_schema'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/model_schema.rb:349:in `attribute_types'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/attribute_methods.rb:179:in `has_attribute?'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.1.0/lib/active_record/inheritance.rb:55:in `new'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos_db_checkpoint-3.0.0/lib/phobos_db_checkpoint/handler.rb:23:in `around_consume'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:147:in `process_message'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (3 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:116:in `block (2 levels) in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:115:in `block in process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'","/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'","/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"],"listener_id":"c9a09a","group_id":"test-1","topic":"test","key":null,"partition":0,"offset":24,"retry_count":4}}
{"timestamp":"2017-05-09T16:18:53.182215+12:00","level":"ERROR","logger":"RubyKafka","message":"Exception raised when processing test/0 in offset range 24..25 -- Phobos::AbortError: Phobos::AbortError\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:139:in `rescue in block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:114:in `block in process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:105:in `process_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (3 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:163:in `measure'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:50:in `block (2 levels) in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:7:in `block in instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/instrumentation.rb:6:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:49:in `block in start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:251:in `block (3 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.0/lib/active_support/notifications.rb:168:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:19:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/instrumenter.rb:33:in `instrument'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:241:in `block (2 levels) in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `each'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:239:in `block in each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:282:in `consumer_loop'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/ruby-kafka-0.3.17/lib/kafka/consumer.rb:236:in `each_batch'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/listener.rb:40:in `start'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:55:in `run_listener'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/phobos-1.2.1/lib/phobos/executor.rb:29:in `block (2 levels) in start'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/kalo/.gem/ruby/2.3.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n/usr/local/var/rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/logging-2.2.2/lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'"}
{"timestamp":"2017-05-09T16:18:53.183247+12:00","level":"INFO","logger":"Phobos","message":{"message":"Retry loop aborted, listener is shutting down","listener_id":"c9a09a","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T16:18:53.183472+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener stopped","listener_id":"c9a09a","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-09T16:18:53.183684+12:00","level":"INFO","logger":"Phobos","message":{"message":"Executor stopped"}}
{"timestamp":"2017-05-10T11:05:09.464087+12:00","level":"INFO","logger":"Phobos","message":{"message":"Phobos configured","env":"development"}}
{"timestamp":"2017-05-10T11:05:10.631600+12:00","level":"INFO","logger":"Phobos","message":{"message":"Listener started","listener_id":"0ed8c3","group_id":"test-1","topic":"test"}}
{"timestamp":"2017-05-10T11:05:10.767132+12:00","level":"INFO","logger":"Phobos","message":{"message":"Committed offset","batch_size":2,"partition":0,"offset_lag":0,"highwater_mark_offset":26,"listener_id":"0ed8c3","group_id":"test-1","topic":"test","time_elapsed":0.062}}
{"timestamp":"2017-05-10T11:05:27.072276+12:00","level":"INFO","logger":"Phobos","message":{"message":"Committed offset","batch_size":1,"partition":0,"offset_lag":0,"highwater_mark_offset":27,"listener_id":"0ed8c3","group_id":"test-1","topic":"test","time_elapsed":0.01}}
